dat <- foo[[2]]
# mono is zero
chrom.type <- dat$chrom
names(chrom.type) <- dat$genus
new.haps <- round(log(dat$haploid)*10)
range(new.haps)
trees <- read.nexus("../data/misof.backbone.nex")
#trees <- read.nexus("../data/rainford.backbone.nex")
dat <- read.csv("../data/data.invert.csv", as.is=T)
source("functions.R")
foo <- getData2(trees, dat)
tree <- foo[[1]][[1]]
dat <- foo[[2]]
# mono is zero
chrom.type <- dat$chrom
names(chrom.type) <- dat$genus
new.haps <- round(log(dat$haploid)*10)
range(new.haps)
maps.est <- make.simmap(tree = tree,
x = chrom.type,
model = "ARD",
pi = "estimated",
nsim=100)
smap.est <- densityMap(trees = maps.est,
res=50, lwd=.75,
check=FALSE,
type="fan",
direction="rightwards",
fsize=.25)
smap.est2 <- setMap(smap.est, c("gray", "black"))
plot(smap.est2, fsize=c(.00001, .4),
lwd=.95,type="fan")
cols <- viridis(38)
tip.cols <- c()
foo <- c()
for(i in 1:length(tree$tip.label)){
hit <- new.haps[dat$genus == tree$tip.label[i]]
foo[i] <- hit
tip.cols[i] <- cols[(hit-6)]
}
tiplabels(pch=16, col = tip.cols, cex=.45)
setwd("~/Desktop/Dropbox/gitrepos/holocentric/scripts")
trees <- read.nexus("../data/misof.backbone.nex")
dat <- read.csv("../data/data.invert.csv", as.is=T)
foo <- getData2(trees, dat)
source("functions.R")
trees <- read.nexus("../data/misof.backbone.nex")
dat <- read.csv("../data/data.invert.csv", as.is=T)
foo <- getData2(trees, dat)
tree <- foo[[1]][[1]]
dat <- foo[[2]]
View(dat)
rm(foo, trees)
source("functions.R")
trees <- read.nexus("../data/misof.backbone.nex")
dat <- read.csv("../data/data.invert.csv", as.is=T)
foo <- getData2(trees, dat)
tree <- foo[[1]][[1]]
dat2 <- foo[[2]]
rm(foo, trees)
View(dat2)
View(dat)
nrow(dat) == length(tree$tip.label)
nrow(dat2) == length(tree$tip.label)
tip.vals <- vector(length=nrow(dat2))
i <- 1
dat$Genus
tree$tip.label[i]
dat$Genus == tree$tip.label[i]
which(dat$Genus == tree$tip.label[i])
tip.vals <- vector(length=nrow(dat2))
for(i in 1:length(tip.vals)){
hit <- which(dat$Genus == tree$tip.label[i])[1]
tip.vals[i] <- dat$Order[hit]
}
class(tree) <- "phylo"
help("plot.phylo")
plot(tree, type="f")
plot(tree, type="f",cex=.3)
plot(tree, type="f",cex=.13)
plot(tree, type="f",show.tip.label = F)
tiplabels(text=tip.vals,cex=.1)
help("tiplabels")
tiplabels(text=tip.vals,cex=.1, frame="none")
plot(tree, type="f",show.tip.label = F)
tiplabels(text=tip.vals,cex=.1, frame="none")
plot(tree, type="f",show.tip.label = F)
tiplabels(text=tip.vals,cex=.2, frame="none")
plot(tree, type="f",show.tip.label = F)
tiplabels(text=tip.vals,cex=.12, frame="none")
load("~/Desktop/Dropbox/gitrepos/holocentric/results/rates.Blattodea.wop.rda")
setwd("~/Desktop/Dropbox/gitrepos/holocentric/scripts")
list.files(path="../data/")
list.files(path="../results/")
results.wp <- results.wop <- matrix(NA, 0, 4)
results.wop <- matrix(NA, 0, 4)
results.wp <- matrix(NA, 0, 5)
colnames(results.wop) <- c("iter","asc","desc","p")
colnames(results.wp) <- c("iter","asc","desc","pol", "p")
View(results.wp)
View(results.wop)
files <- list.files(path="../results/")
j <- 1
files <- list.files(path="../results/")
results.wop <- matrix(NA, 0, 4)
results.wp <- matrix(NA, 0, 5)
colnames(results.wop) <- c("iter","asc","desc","p")
colnames(results.wp) <- c("iter","asc","desc","pol", "p")
j <- 1
paste("../results/",files[j],sep="")
load(file=paste("../results/",files[j],sep=""))
ncol(x[[1]])
files <- list.files(path="../results/")
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "order", "type")
View(results.wop)
j <- 1
load(file=paste("../results/",files[j],sep=""))
ncol(x[[1]]) == 4
i <- 1
x[[i]][26:50,]
x[[i]][26:50,1:2]
x[[i]][26:50,2:3]
strsplit(files[j], split=".")[[1]]
strsplit(files[j], split=".")
files[j]
help(strsplit)
strsplit(files[j], split=".", fixed=T)
strsplit(files[j], split=".", fixed=T)[[1]][2]
rates <- orders <- types <- c()
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc", each = 25)))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
rates <- orders <- types <- c()
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "order", "type")
results.wop <- rbind(results.wop, foo)
}
View(results.wop)
View(results.wop)
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
nrow(results.wop)
rates <- orders <- types <- c()
i <- 1
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,2])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
View(results.wop)
j <- 2
paste("../results/",files[j],sep="")
load(file=paste("../results/",files[j],sep=""))
ncol(x[[1]]) == 5
strsplit(files[j], split=".", fixed=T)[[1]][2]
files <- list.files(path="../results/")
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
50*100*10
files <- list.files(path="../results/")
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
j<-1
print(files[j])
load(file=paste("../results/",files[j],sep=""))
ncol(x[[1]]) == 4
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
ncol(x[[1]]) == 5
j<-2
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
nrow(results.wp)
j <- 3
print(files[j])
load(file=paste("../results/",files[j],sep=""))
ncol(x[[1]]) == 4
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
nrow(results.wop)
files <- list.files(path="../results/")
results.wop <- results.wp <- matrix(NA, 0, 3)
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
nrow(results.wop)
nrow(results.wp)
ls()
ls()[-c(7:8)]
rm(list=ls()[-c(7:8)])
results.wop <- as.data.frame(results.wop)
results.wp <- as.data.frame(results.wp)
results.wop$rate
View(results.wop)
results.wop$rate <- as.numeric(results.wop$rate)
View(results.wop)
files <- list.files(path="../results/")
results.wop <- results.wp <- as.data.frame(matrix(NA, 0, 3))
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- cbind(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
rm(list=ls()[-c(7:8)])
results.wop$rate
save.image("~/Desktop/Dropbox/gitrepos/holocentric/results/munged.data.environment.RData")
library(ggraptR)
ggraptR(results.wop)
ggraptR(results.wp)
results.wp$rate
files <- list.files(path="../results/")
results.wop <- results.wp <- as.data.frame(matrix(NA, 0, 3))
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
rm(list=ls()[-c(7:8)])
results.wop <- as.data.frame(results.wop)
results.wp <- as.data.frame(results.wp)
files <- list.files(path="../results/")
results.wop <- results.wp <- as.data.frame(matrix(NA, 0, 3))
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
files <- list.files(path="../results/")
results.wop <- results.wp <- as.data.frame(matrix(NA, 0, 3))
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
rm(list=ls()[-c(7:8)])
ggraptR(results.wp)
files <- list.files(path="../results/")
results.wop <- results.wp <- as.data.frame(matrix(NA, 0, 3))
colnames(results.wop) <- colnames(results.wp) <-
c("rate", "type", "order")
for(j in 1:length(files)){
print(files[j])
load(file=paste("../results/",files[j],sep=""))
if(ncol(x[[1]]) == 4){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3])
types <- c(types, rep(c("asc", "desc"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 50))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wop <- rbind(results.wop, foo)
}
if(ncol(x[[1]]) == 5){
rates <- orders <- types <- c()
for(i in 1:100){
rates <- c(rates, x[[i]][26:50,2], x[[i]][26:50,3], x[[i]][26:50,4])
types <- c(types, rep(c("asc", "desc", "pol"), each = 25))
foo <- strsplit(files[j], split=".", fixed=T)[[1]][2]
orders <- c(orders, rep(foo, 75))
}
foo <- data.frame(rates, types, orders)
colnames(foo) <- c("rate", "type", "order")
results.wp <- rbind(results.wp, foo)
}
}
rm(list=ls()[-c(7:8)])
save.image("~/Desktop/Dropbox/gitrepos/holocentric/results/munged.data.RData")
